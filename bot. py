import telebot
from telebot import types
import os

# âœ… Ø§Ø³ØªØ®Ø¯Ù… BOT_TOKEN Ù…Ù† Variables Ø¹Ù„Ù‰ Railway
TOKEN = os.getenv("BOT_TOKEN")
bot = telebot.TeleBot(TOKEN)

# ----------------- Main Menu -----------------
def main_menu():
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    markup.row('Basic Science', 'Clinical Science')
    return markup

# ----------------- Basic Science Menu -----------------
def basic_science_menu():
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    markup.row('Terminology', 'Anatomy')
    markup.row('Biochemistry', 'Physiology')
    markup.row('Pathology', 'Pharmacology', 'Microbiology')
    markup.row('ğŸ”™ Back', 'ğŸ” Main Menu')
    return markup

# ----------------- Anatomy Submenu -----------------
def anatomy_menu():
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    markup.row('Gross Anatomy', 'Histology', 'Embryology')
    markup.row('ğŸ”™ Back', 'ğŸ” Main Menu')
    return markup

# ----------------- Clinical Science Menu -----------------
def clinical_science_menu():
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    markup.row('Internal Medicine', 'Obs/Gyn')
    markup.row('Surgery', 'Pediatrics')
    markup.row('Community Medicine', 'Forensic Medicine')
    markup.row('ğŸ”™ Back', 'ğŸ” Main Menu')
    return markup

# ----------------- Start Command -----------------
@bot.message_handler(commands=['start'])
def send_welcome(message):
    bot.send_message(message.chat.id,
                     "Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Medical Bot! Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©:",
                     reply_markup=main_menu())

# ----------------- Handling Messages -----------------
@bot.message_handler(func=lambda message: True)
def handle_message(message):
    text = message.text

    # Main Menu
    if text == 'Basic Science':
        bot.send_message(message.chat.id, "Ø§Ø®ØªØ± Ù…Ø§Ø¯Ø©:", reply_markup=basic_science_menu())
    elif text == 'Clinical Science':
        bot.send_message(message.chat.id, "Ø§Ø®ØªØ± Ù…Ø§Ø¯Ø©:", reply_markup=clinical_science_menu())

    # Basic Science Submenus
    elif text == 'Terminology':
        bot.send_message(message.chat.id, "âš¡ Terminology", reply_markup=basic_science_menu())
    elif text == 'Anatomy':
        bot.send_message(message.chat.id, "Ø§Ø®ØªØ± Ù‚Ø³Ù… Anatomy:", reply_markup=anatomy_menu())
    elif text == 'Biochemistry':
        bot.send_message(message.chat.id, "âš¡ Biochemistry", reply_markup=basic_science_menu())
    elif text == 'Physiology':
        bot.send_message(message.chat.id, "âš¡ Physiology", reply_markup=basic_science_menu())
    elif text == 'Pathology':
        bot.send_message(message.chat.id, "âš¡ Pathology", reply_markup=basic_science_menu())
    elif text == 'Pharmacology':
        bot.send_message(message.chat.id, "âš¡ Pharmacology", reply_markup=basic_science_menu())
    elif text == 'Microbiology':
        bot.send_message(message.chat.id, "âš¡ Microbiology", reply_markup=basic_science_menu())

    # Anatomy Subsections
    elif text in ['Gross Anatomy', 'Histology', 'Embryology']:
        bot.send_message(message.chat.id, f"âš¡ {text}", reply_markup=anatomy_menu())

    # Clinical Science Submenus
    elif text in ['Internal Medicine', 'Obs/Gyn', 'Surgery', 'Pediatrics', 'Community Medicine', 'Forensic Medicine']:
        bot.send_message(message.chat.id, f"âš¡ {text}", reply_markup=clinical_science_menu())

    # Navigation
    elif text == 'ğŸ”™ Back':
        bot.send_message(message.chat.id, "Ø§Ø®ØªØ±:", reply_markup=main_menu())
    elif text == 'ğŸ” Main Menu':
        bot.send_message(message.chat.id, "Ø§Ø±Ø¬Ø¹ Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:", reply_markup=main_menu())
    else:
        bot.send_message(message.chat.id, "âŒ Ø®ÙŠØ§Ø± ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙØŒ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ø§Ù„Ù‚ÙˆØ§Ø¦Ù….", reply_markup=main_menu())

# ----------------- Run Bot -----------------
bot.infinity_polling()